{% extends 'layouts/base.html' %}

{% block title %}Recursos Internos{% endblock %}

{% block content %}
<div class="container-fluid">
    <h2 class="mb-4" style="color: #ffc107;">Gerenciar Recursos Internos</h2>
    <ul class="nav nav-tabs mb-3" id="recursosTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="equipamentos-tab" data-bs-toggle="tab" data-bs-target="#equipamentos" type="button" role="tab" aria-controls="equipamentos" aria-selected="true">Equipamentos</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="veiculos-tab" data-bs-toggle="tab" data-bs-target="#veiculos" type="button" role="tab" aria-controls="veiculos" aria-selected="false">Veículos</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="dispositivos-tab" data-bs-toggle="tab" data-bs-target="#dispositivos" type="button" role="tab" aria-controls="dispositivos" aria-selected="false">Dispositivos</button>
      </li>
    </ul>
    <div class="tab-content" id="recursosTabContent">
      <div class="tab-pane fade show active" id="equipamentos" role="tabpanel" aria-labelledby="equipamentos-tab">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <p class="text-secondary mb-0">Lista de equipamentos cadastrados.</p>
          <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modalAdicionarEquipamento">Adicionar Equipamento</button>
        </div>
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>Nome</th>
              <th>Descrição</th>
              <th>Ativo</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            {% for equipamento in equipamentos %}
            <tr>
              <td>{{ equipamento.id }}</td>
              <td>{{ equipamento.nome }}</td>
              <td>{{ equipamento.descricao }}</td>
              <td>{{ 'Sim' if equipamento.ativo else 'Não' }}</td>
              <td>
                <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#modalEditarEquipamento{{ equipamento.id }}">Editar</button>
                <form method="POST" action="{{ url_for('recursos.remover_recurso', tipo='equipamento', id=equipamento.id) }}" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Remover este equipamento?')">Remover</button>
                </form>
              </td>
            </tr>
            <!-- Modal Editar Equipamento -->
            <div class="modal fade" id="modalEditarEquipamento{{ equipamento.id }}" tabindex="-1">
              <div class="modal-dialog">
                <div class="modal-content">
                  <form method="POST" action="{{ url_for('recursos.editar_equipamento', id=equipamento.id) }}">
                    <div class="modal-header">
                      <h5 class="modal-title">Editar Equipamento</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                      <input type="text" name="nome" value="{{ equipamento.nome }}" class="form-control mb-2" required>
                      <textarea name="descricao" class="form-control mb-2">{{ equipamento.descricao }}</textarea>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="ativo" {% if equipamento.ativo %}checked{% endif %}>
                        <label class="form-check-label">Ativo</label>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="submit" class="btn btn-success">Salvar</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            {% endfor %}
          </tbody>
        </table>
        <!-- Modal Adicionar Equipamento -->
        <div class="modal fade" id="modalAdicionarEquipamento" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <form method="POST" action="{{ url_for('recursos.criar_recursos') }}">
                <div class="modal-header">
                  <h5 class="modal-title">Adicionar Equipamento</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <input type="hidden" name="tipo" value="equipamento">
                  <input type="text" name="nome" class="form-control mb-2" placeholder="Nome" required>
                  <textarea name="descricao" class="form-control mb-2" placeholder="Descrição"></textarea>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="ativo" checked>
                    <label class="form-check-label">Ativo</label>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="veiculos" role="tabpanel" aria-labelledby="veiculos-tab">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <p class="text-secondary mb-0">Lista de veículos cadastrados.</p>
          <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modalAdicionarVeiculo">Adicionar Veículo</button>
        </div>
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>Nome</th>
              <th>Descrição</th>
              <th>Ativo</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            {% for veiculo in veiculos %}
            <tr>
              <td>{{ veiculo.id }}</td>
              <td>{{ veiculo.nome }}</td>
              <td>{{ veiculo.descricao }}</td>
              <td>{{ 'Sim' if veiculo.ativo else 'Não' }}</td>
              <td>
                <form method="POST" action="{{ url_for('recursos.remover_recurso', tipo='veiculo', id=veiculo.id) }}" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Remover este veículo?')">Remover</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <!-- Modal Adicionar Veículo -->
        <div class="modal fade" id="modalAdicionarVeiculo" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <form method="POST" action="{{ url_for('recursos.criar_recursos') }}">
                <div class="modal-header">
                  <h5 class="modal-title">Adicionar Veículo</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <input type="hidden" name="tipo" value="veiculo">
                  <input type="text" name="nome" class="form-control mb-2" placeholder="Nome" required>
                  <textarea name="descricao" class="form-control mb-2" placeholder="Descrição"></textarea>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="ativo" checked>
                    <label class="form-check-label">Ativo</label>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="dispositivos" role="tabpanel" aria-labelledby="dispositivos-tab">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <p class="text-secondary mb-0">Lista de dispositivos de segurança cadastrados.</p>
          <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modalAdicionarDispositivo">Adicionar Dispositivo</button>
        </div>
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>Nome</th>
              <th>Descrição</th>
              <th>Ativo</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            {% for dispositivo in dispositivos %}
            <tr>
              <td>{{ dispositivo.id }}</td>
              <td>{{ dispositivo.nome }}</td>
              <td>{{ dispositivo.descricao }}</td>
              <td>{{ 'Sim' if dispositivo.ativo else 'Não' }}</td>
              <td>
                <form method="POST" action="{{ url_for('recursos.remover_recurso', tipo='dispositivo', id=dispositivo.id) }}" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Remover este dispositivo?')">Remover</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <!-- Modal Adicionar Dispositivo -->
        <div class="modal fade" id="modalAdicionarDispositivo" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <form method="POST" action="{{ url_for('recursos.criar_recursos') }}">
                <div class="modal-header">
                  <h5 class="modal-title">Adicionar Dispositivo</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <input type="hidden" name="tipo" value="dispositivo">
                  <input type="text" name="nome" class="form-control mb-2" placeholder="Nome" required>
                  <textarea name="descricao" class="form-control mb-2" placeholder="Descrição"></textarea>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="ativo" checked>
                    <label class="form-check-label">Ativo</label>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>
{% endblock %}